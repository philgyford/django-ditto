

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flickr &mdash; Django Ditto 3.7.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=229cbe3b"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Last.fm" href="lastfm.html" />
    <link rel="prev" title="Installation" href="../installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Django Ditto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Services supported</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Flickr</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#set-up">Set-up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managers">Managers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#photos">Photos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#users">Users</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#template-tags">Template tags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#annual-photo-counts">Annual Photo Counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#day-photos">Day Photos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photosets">Photosets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photo-license">Photo license</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recent-photos">Recent Photos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#management-commands">Management commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fetch-account-user">Fetch Account User</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-photos">Fetch Photos</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-originals">Fetch originals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-photosets">Fetch Photosets</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="lastfm.html">Last.fm</a></li>
<li class="toctree-l1"><a class="reference internal" href="pinboard.html">Pinboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="twitter.html">Twitter</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Elsewhere</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/philgyford/django-ditto">Django Ditto on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.python.org/pypi/django-ditto">Django Ditto on PyPI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Django Ditto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Flickr</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/services/flickr.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flickr">
<h1>Flickr<a class="headerlink" href="#flickr" title="Link to this heading"></a></h1>
<p>You can fetch, store and display data about all your Photos and Photosets (Albums) for one or more <a class="reference external" href="https://flickr.com/">Flickr</a> Accounts. By default the included models and templates will link to the photo files on flickr.com, but you can also download the original files to store locally. These can then be used to generate images in all other sizes, to be served locally.  See the <a class="reference external" href="#fetch-files-media">Fetch Files management command</a> below.</p>
<section id="set-up">
<h2>Set-up<a class="headerlink" href="#set-up" title="Link to this heading"></a></h2>
<p>In the Django admin, create a new <code class="docutils literal notranslate"><span class="pre">Account</span></code> in the Flickr app, and add your Flickr API key and secret from <a class="reference external" href="https://www.flickr.com/services/apps/create/apply/">https://www.flickr.com/services/apps/create/apply/</a> (you can ignore the User for the moment).</p>
<p>By default this will only allow the fetching of fully public photos. To fetch all photos your Flickr account can access, you’ll need to do this:</p>
<ol class="arabic">
<li><p>Enter your API key and secret in the indicated place in the file
<code class="docutils literal notranslate"><span class="pre">ditto/scripts/flickr_authorize.py</span></code>. (If you’ve installed Ditto using pip,
it might be easier to <a class="reference external" href="https://github.com/philgyford/django-ditto/blob/main/ditto/scripts/flickr_authorize.py">download the script from GitHub</a>.)</p></li>
<li><p>Run the script on the command line (if you downloaded the file, change the path to wherever the script is):</p>
<blockquote>
<div><div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>ditto/scripts/flickr_authorize.py
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Follow the instructions. You should get a URL to paste into a web browser,
in order to authorize your Flickr account. You’ll then get a code to paste
into your Terminal.</p></li>
</ol>
<p>Finally, back in the Django Admin note the ID of the <code class="docutils literal notranslate"><span class="pre">Account</span></code> you created. e.g. if the Django Admin’s URL is something like <code class="docutils literal notranslate"><span class="pre">/admin/flickr/account/1/change/</span></code> then the ID is <code class="docutils literal notranslate"><span class="pre">1</span></code>. Run the following management command to fetch information about the <code class="docutils literal notranslate"><span class="pre">Account</span></code>’s associated Flickr <code class="docutils literal notranslate"><span class="pre">User</span></code> (replacing <code class="docutils literal notranslate"><span class="pre">1</span></code> with your <code class="docutils literal notranslate"><span class="pre">Account</span></code>’s Django ID, if different):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_account_user<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>Now you can download your photos’ data and, optionally, their original image/video files. See <a class="reference internal" href="#flickr-management-commands"><span class="std std-ref">Management commands</span></a>.</p>
</section>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h2>
<p>The models available in <code class="docutils literal notranslate"><span class="pre">ditto.flickr.models</span></code> are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Account</span></code></dt><dd><p>Representing a Flickr account that has API credentials and that we fetch Photos for. It has a one-to-one relationship with a <code class="docutils literal notranslate"><span class="pre">User</span></code> model.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TaggedPhoto</span></code></dt><dd><p>The through model relating Photos to tags.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Photo</span></code></dt><dd><p>A photo (or video) on Flickr. The <code class="docutils literal notranslate"><span class="pre">media_type</span></code> property of <code class="docutils literal notranslate"><span class="pre">'photo'</span></code> or <code class="docutils literal notranslate"><span class="pre">'video'</span></code> indicates which type this is.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Photoset</span></code></dt><dd><p>A photoset (album) containing Photos.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">User</span></code></dt><dd><p>A single user on Flickr. There could be lots of Users but only one (or a few) will have associated Account objects – these are the Users we fetch Photos for.</p>
</dd>
</dl>
</section>
<section id="managers">
<h2>Managers<a class="headerlink" href="#managers" title="Link to this heading"></a></h2>
<section id="photos">
<h3>Photos<a class="headerlink" href="#photos" title="Link to this heading"></a></h3>
<p>There are several managers available for Photos. There are two main
differentiators we want to restrict things by:</p>
<ul class="simple">
<li><p><strong>Public vs private:</strong> Whether a Photo is public or private (which includes those marked as for Friends and/or Family on Flickr.com).</p></li>
<li><p><strong>Posted Photo vs Favorited Photo:</strong> In the future we may fetch Photos that have been favorited, rather than posted, by our Users that have Accounts. In this case we’d want to be able to differentiate between Photos that we posted, and Photos that we favorited.</p></li>
</ul>
<p>On public-facing web pages you should only use the mangaers starting <code class="docutils literal notranslate"><span class="pre">Photo.public_</span></code> as these will filter out all Photos that are not public.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Photo.objects.all()</span></code></dt><dd><p>The default manager fetches <em>all</em> Photos in the system. Public, private, posted by you or (in the future) only favorited by you.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Photo.public_objects.all()</span></code></dt><dd><p>Gets all public Photos in the system, no matter who posted them to Flickr.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Photo.photo_objects.all()</span></code></dt><dd><p>Gets all Photos, public or private, that were posted by one of the Users associated with an API-credentialled Account.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Photo.public_photo_objects.all()</span></code></dt><dd><p>Gets public Photos that were posted by one of the Users associated with an API-credentialled Account.</p>
</dd>
</dl>
<p>Of course, these can all be filtered as usual. So, if you wanted to get all the public Photos posted by a particular <code class="docutils literal notranslate"><span class="pre">User</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ditto.flickr.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span><span class="p">,</span> <span class="n">Photo</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nsid</span><span class="o">=</span><span class="s1">&#39;35034346050@N01&#39;</span><span class="p">)</span>
<span class="n">photos</span> <span class="o">=</span> <span class="n">Photo</span><span class="o">.</span><span class="n">public_photo_objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>NOTE: You can find a user’s NSID (the ID used by Flickr) at <a class="reference external" href="http://idgettr.com">http://idgettr.com</a></p>
</section>
<section id="users">
<h3>Users<a class="headerlink" href="#users" title="Link to this heading"></a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">User.objects.all()</span></code></dt><dd><p>The default manager fetches all Users in the system.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">User.objects_with_accounts.all()</span></code></dt><dd><p>This only gets Users that are associated with Accounts.</p>
</dd>
</dl>
</section>
</section>
<section id="template-tags">
<h2>Template tags<a class="headerlink" href="#template-tags" title="Link to this heading"></a></h2>
<p>There are three assigment template tags and one simple template tag available for displaying Photos, Photosets and information about a Photo.</p>
<section id="annual-photo-counts">
<h3>Annual Photo Counts<a class="headerlink" href="#annual-photo-counts" title="Link to this heading"></a></h3>
<p>Get the number of Photos taken or uploaded per year for all or one User-with-Account. This fetches totals for all Users, by time uploaded:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">annual_photo_counts</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">row</span> <span class="k">in</span> <span class="nv">counts</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">row.year</span> <span class="cp">}}</span><span class="x">: </span><span class="cp">{{</span> <span class="nv">row.count</span> <span class="cp">}}</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">count</span></code> in each row are integers.</p>
<p>To count by time taken instead:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">annual_photo_counts</span> <span class="nv">count_by</span><span class="o">=</span><span class="s1">&#39;taken_time&#39;</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>The alternative <code class="docutils literal notranslate"><span class="pre">count_by</span></code> value is equivalent to the default behaviour:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">annual_photo_counts</span> <span class="nv">count_by</span><span class="o">=</span><span class="s1">&#39;post_time&#39;</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>To restrict totals to a single User-with-Account, include their <code class="docutils literal notranslate"><span class="pre">nsid</span></code>:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">annual_photo_counts</span> <span class="nv">nsid</span><span class="o">=</span><span class="s1">&#39;35034346050@N01&#39;</span> <span class="nv">count_by</span><span class="o">=</span><span class="s1">&#39;taken_time&#39;</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="day-photos">
<h3>Day Photos<a class="headerlink" href="#day-photos" title="Link to this heading"></a></h3>
<p>Gets public Photos posted or taken on a particular day by any of the Users-with-Accounts. In this example, <code class="docutils literal notranslate"><span class="pre">my_date</span></code> is a <a class="reference external" href="https://docs.python.org/3.5/library/datetime.html#datetime.date">datetime.datetime.date</a> type:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">day_photos</span> <span class="nv">my_date</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>By default this will return photos posted on the date. To specify whether it
uses <code class="docutils literal notranslate"><span class="pre">post_time</span></code> or <code class="docutils literal notranslate"><span class="pre">taken_time</span></code> use the <code class="docutils literal notranslate"><span class="pre">time</span></code> parameter:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">day_photos</span> <span class="nv">my_date</span> <span class="nv">time</span><span class="o">=</span><span class="s1">&#39;post_time&#39;</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">day_photos</span> <span class="nv">my_date</span> <span class="nv">time</span><span class="o">=</span><span class="s1">&#39;taken_time&#39;</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Or we can restrict this to Photos posted by a single User-with-an-Account:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">day_photos</span> <span class="nv">my_date</span> <span class="nv">time</span><span class="o">=</span><span class="s1">&#39;post_time&#39;</span> <span class="nv">nsid</span><span class="o">=</span><span class="s1">&#39;35034346050@N01&#39;</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="photosets">
<h3>Photosets<a class="headerlink" href="#photosets" title="Link to this heading"></a></h3>
<p>Gets Photosets. By default they are by any User and only 10 are returned.</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">photosets</span> <span class="k">as</span> <span class="nv">photoset_list</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">photoset</span> <span class="k">in</span> <span class="nv">photoset_list</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">photoset.title</span> <span class="cp">}}</span><span class="x">&lt;br&gt;</span>
<span class="x">        &lt;img src=&quot;</span><span class="cp">{{</span> <span class="nv">photoset.primary_photo.large_square_url</span> <span class="cp">}}</span><span class="x">&quot; width=&quot;</span><span class="cp">{{</span> <span class="nv">photoset.primary_photo.large_square_width</span> <span class="cp">}}</span><span class="x">&quot; height=&quot;</span><span class="cp">{{</span> <span class="nv">photoset.primary_photo.large_square_height</span> <span class="cp">}}</span><span class="x">&quot;&gt;</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>You can restrict it to Photosets by a single User and/or change the number returned:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">photosets</span> <span class="nv">nsid</span><span class="o">=</span><span class="s1">&#39;35034346050@N01&#39;</span> <span class="nv">limit</span><span class="o">=</span><span class="m">300</span> <span class="k">as</span> <span class="nv">photoset_list</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="photo-license">
<h3>Photo license<a class="headerlink" href="#photo-license" title="Link to this heading"></a></h3>
<p>When displaying information about a <code class="docutils literal notranslate"><span class="pre">Photo</span></code> you may want to display a user-friendly version of its <code class="docutils literal notranslate"><span class="pre">license</span></code> (indicating Creative Commons level, All rights reserved, etc). This tag makes that easy. Pass it the <code class="docutils literal notranslate"><span class="pre">license</span></code> property of a <code class="docutils literal notranslate"><span class="pre">Photo</span></code> object. Here, <code class="docutils literal notranslate"><span class="pre">photo</span></code> is a <code class="docutils literal notranslate"><span class="pre">Photo</span></code> object:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{{</span> <span class="nv">photo_license</span> <span class="nv">photo.license</span> <span class="cp">}}</span>
</pre></div>
</div>
<p>This would create HTML something like this, depending on the license:</p>
<blockquote>
<div><p>&lt;a href=”<a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/2.0/">https://creativecommons.org/licenses/by-nc-sa/2.0/</a>” title=”More about permissions”&gt;Attribution-NonCommercial-ShareAlike License&lt;/a&gt;</p>
</div></blockquote>
</section>
<section id="recent-photos">
<h3>Recent Photos<a class="headerlink" href="#recent-photos" title="Link to this heading"></a></h3>
<p>To display the most recent public Photos posted by any of the Users associated
with Accounts. By default the most recent 10 are fetched:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_flickr</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">recent_photos</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">photo</span> <span class="k">in</span> <span class="nv">photos</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">photo.title</span> <span class="cp">}}</span><span class="x">&lt;br&gt;</span>
<span class="x">        &lt;img src=&quot;</span><span class="cp">{{</span> <span class="nv">photo.small_url</span> <span class="cp">}}</span><span class="x">&quot; width=&quot;</span><span class="cp">{{</span> <span class="nv">photo.small_width</span> <span class="cp">}}</span><span class="x">&quot; height=&quot;</span><span class="cp">{{</span> <span class="nv">photo.small_height</span> <span class="cp">}}</span><span class="x">&quot;&gt;</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>The tag can also fetch a different number of Photos and/or only get Photos
posted by a single User-with-an-Account. Here we only get the 5 most recent
Photos posted by the User with an <code class="docutils literal notranslate"><span class="pre">nsid</span></code> of <code class="docutils literal notranslate"><span class="pre">'35034346050&#64;N01'</span></code>:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">recent_photos</span> <span class="nv">nsid</span><span class="o">=</span><span class="s1">&#39;35034346050@N01&#39;</span> <span class="nv">limit</span><span class="o">=</span><span class="m">5</span> <span class="k">as</span> <span class="nv">photos</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
</section>
<section id="management-commands">
<span id="flickr-management-commands"></span><h2>Management commands<a class="headerlink" href="#management-commands" title="Link to this heading"></a></h2>
<section id="fetch-account-user">
<h3>Fetch Account User<a class="headerlink" href="#fetch-account-user" title="Link to this heading"></a></h3>
<p>This is only used when setting up a new <code class="docutils literal notranslate"><span class="pre">Account</span></code> object with API credentials. It fetches data about the Flickr User associated with this <code class="docutils literal notranslate"><span class="pre">Account</span></code>.</p>
<p>Once the <code class="docutils literal notranslate"><span class="pre">Account</span></code> has been created in the Django admin, and its API credentials entered, run this (using the Django ID for the object instead of <code class="docutils literal notranslate"><span class="pre">1</span></code>):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_account_user<span class="w"> </span>--id<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="fetch-photos">
<h3>Fetch Photos<a class="headerlink" href="#fetch-photos" title="Link to this heading"></a></h3>
<p>Fetches data about Photos (including videos). The data fetched can be restricted by setting:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--days</span></code> - fetch data from that many most recent days</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--start</span></code> - fetch from that date onward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--end</span></code> - fetch from that date and earlier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--account</span></code> - only fetch for a single Flickr account</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> arguments can be combined to fetch data from within a range of dates.</p>
<p>If no <cite>–account</cite> argument is supplied, data is fecthed for ALL Accounts.</p>
<p>So, this will fetch data for ALL Photos for ALL Accounts:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--days<span class="o">=</span>all
</pre></div>
</div>
<p><strong>NOTE 1:</strong> This took about 75 minutes to fetch data for 3,000 photos on my MacBook.</p>
<p><strong>NOTE 2:</strong> Trying to run the same thing on a 512MB Digital Ocean machine resulted in the process being killed after fetching about 1,500 photos. See <a class="reference external" href="https://github.com/philgyford/django-ditto/issues/148">this bug</a>.</p>
<p>This will only fetch Photos uploaded in the past 3 days:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--days<span class="o">=</span><span class="m">3</span>
</pre></div>
</div>
<p>This will fetch Photos uploaded since midnight at the start of 31 December 2021:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--start<span class="o">=</span><span class="m">2021</span>-12-31
</pre></div>
</div>
<p>This will fetch Photos uploaded before the end of the day (23:59:59) on 1 February 2022:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--end<span class="o">=</span><span class="m">2022</span>-02-01
</pre></div>
</div>
<p>And this will fetch Photos uploaded from the start of 31 December 2021 and the end of 1 February 2022:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--start<span class="o">=</span><span class="m">2021</span>-12-31<span class="w"> </span>--end<span class="o">=</span><span class="m">2022</span>-02-01
</pre></div>
</div>
<p>All time-related options can be restricted to only fetch for a single Account by adding the NSID of the Account’s User, eg:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photos<span class="w"> </span>--account<span class="o">=</span><span class="m">35034346050</span>@N01<span class="w"> </span>--days<span class="o">=</span><span class="m">3</span>
</pre></div>
</div>
<p>Whenever a Photo is fetched, data about its User will also be fetched, if it hasn’t been fetched on this occasion.</p>
<p>Profile photos of Users are downloaded and stored in your project’s <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> directory. You can optionally set the <code class="docutils literal notranslate"><span class="pre">DITTO_FLICKR_DIR_BASE</span></code> setting to change the location. The default is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;flickr&#39;</span>
</pre></div>
</div>
<p>If your <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> was set to <code class="docutils literal notranslate"><span class="pre">/var/www/example.com/media/</span></code> then the above setting would save the profile image for the user with NSID <code class="docutils literal notranslate"><span class="pre">35034346050&#64;N01</span></code> to something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/var/www/example.com/media/flickr/46/05/35034346050N01/avatars/35034346050N01.jpg
</pre></div>
</div>
</section>
<section id="fetch-originals">
<h3>Fetch originals<a class="headerlink" href="#fetch-originals" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">fetch_flickr_photos</span></code> management command only fetches data <em>about</em> the photos (title, locations, EXIF, tags, etc). To download the original photo and video files themselves, use the <code class="docutils literal notranslate"><span class="pre">fetch_flickr_originals</span></code> command, <em>after</em> fetching the photos’ data:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_originals
</pre></div>
</div>
<p>This took over 90 minutes for about 3,000 photos (and very few videos) for me.</p>
<p>By default this command will fetch all the original files that haven’t yet been downloaded (so the first time, it will fetch all of them). To force it to download <em>all</em> the files again (if you’ve deleted them locally, but they’re still on Flickr) then:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_originals<span class="w"> </span>--all
</pre></div>
</div>
<p>Both variants can be restricted to fetching files for a single account:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_originals<span class="w"> </span>--account<span class="o">=</span><span class="m">35034346050</span>@N01
</pre></div>
</div>
<p>Files will be saved within your project’s <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> directory, as defined in <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>. There are two optional settings to customise the directories in which the files are saved. Their default values are as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;flickr&#39;</span>
<span class="n">DITTO_FLICKR_DIR_PHOTOS_FORMAT</span> <span class="o">=</span> <span class="s1">&#39;%Y/%m/</span><span class="si">%d</span><span class="s1">&#39;</span>
</pre></div>
</div>
<p>These values are used if you don’t specify your own settings.</p>
<p>If your <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> was set to <code class="docutils literal notranslate"><span class="pre">/var/www/example.com/media/</span></code> then the above settings would save the Flickr photo <code class="docutils literal notranslate"><span class="pre">1234567_987654_o.jpg</span></code> to something like this, depending on the Flickr user’s NSID and the date the photo was taken (not uploaded):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/var/www/example.com/media/flickr/35034346050N01/photos/2016/08/31/1234567_987654_o.jpg
</pre></div>
</div>
<p>Note that videos will have <em>two</em> “original” files downloaded: the video itself and a JPG image that Flickr created for it.</p>
<p>Once you’ve downloaded the original image files, you can use these to generate all the different sizes of image required for your site, instead of linking direct to the image files on flickr.com. To do this, ensure <code class="docutils literal notranslate"><span class="pre">imagekit</span></code> is in your <code class="docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code> setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;imagekit&#39;</span><span class="p">,</span>
    <span class="c1"># ...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And add this to your <cite>settings.py</cite> (its default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_FLICKR_USE_LOCAL_MEDIA</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Any requests in your templates for the URLs of photo files of any size will now use resized versions of your downloaded original files, generated by Imagekit.  The first time you load a page (especially if it lists many Flickr images) it will be slow, but the images are cached (in a <code class="docutils literal notranslate"><span class="pre">CACHE</span></code> directory in your media folder).</p>
<p>For example, before changing this setting, the URL of small image (<code class="docutils literal notranslate"><span class="pre">Photo.small_url</span></code>) would be something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>https://farm8.static.flickr.com/7442/27289611500_d0debff24e_m.jpg
</pre></div>
</div>
<p>After choosing to use local photos, it would be something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/media/CACHE/images/flickr/35034346050N01/photos/2016/06/09/27289611500_d21f6f47a0_o/0ee894a3438233848e6e9d85e1985260.jpg
</pre></div>
</div>
<p>If you change your mind you can switch back to using the images hosted on flickr.com by removing the <code class="docutils literal notranslate"><span class="pre">DITTO_FLICKR_USE_LOCAL_MEDIA</span></code> setting or changing it to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Note that Ditto currently can’t do the same for videos, even if the original video file has been downloaded. No matter what the  value of <code class="docutils literal notranslate"><span class="pre">DITTO_FLICKR_USE_LOCAL_MEDIA</span></code> the flickr.com URL for videos is always used.</p>
</section>
<section id="fetch-photosets">
<h3>Fetch Photosets<a class="headerlink" href="#fetch-photosets" title="Link to this heading"></a></h3>
<p>You can fetch data about your Photosets any time, but it doesn’t fetch detailed data about Photos within them.</p>
<p>So, for best results, only run this <em>after</em> getting running <code class="docutils literal notranslate"><span class="pre">fetch_flickr_photos</span></code>.</p>
<p>To fetch Photosets for all Accounts:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photosets
</pre></div>
</div>
<p>Or fetch for only one Account:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_flickr_photosets<span class="w"> </span>--account<span class="o">=</span><span class="m">35034346050</span>@N01
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lastfm.html" class="btn btn-neutral float-right" title="Last.fm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-25, Phil Gyford.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>