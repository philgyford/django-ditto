

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Twitter &mdash; Django Ditto 3.6.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f731707b"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Development" href="../development.html" />
    <link rel="prev" title="Pinboard" href="pinboard.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Django Ditto
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Services supported</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="flickr.html">Flickr</a></li>
<li class="toctree-l1"><a class="reference internal" href="lastfm.html">Last.fm</a></li>
<li class="toctree-l1"><a class="reference internal" href="pinboard.html">Pinboard</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Twitter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#set-up">Set-up</a></li>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managers">Managers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#media">Media</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tweet">Tweet</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#template-tags">Template tags</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#annual-favorite-counts">Annual Favorite Counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#annual-tweet-counts">Annual Tweet Counts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#day-favorites">Day Favorites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#day-tweets">Day Tweets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recent-favorites">Recent Favorites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recent-tweets">Recent Tweets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#management-commands">Management commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#import-tweets">Import Tweets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-tweets">Update Tweets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-tweets">Fetch Tweets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-favorites">Fetch Favorites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-users">Update Users</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-files-media">Fetch Files (Media)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fetch-accounts">Fetch Accounts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Elsewhere</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/philgyford/django-ditto">Django Ditto on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.python.org/pypi/django-ditto">Django Ditto on PyPI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Django Ditto</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Twitter</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/services/twitter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="twitter">
<h1>Twitter<a class="headerlink" href="#twitter" title="Link to this heading"></a></h1>
<p>You can fetch, store and display data about your own Tweets and Liked Tweets for one or more <a class="reference external" href="https://twitter.com/">Twitter</a> accounts. By default the included models and templates will link to image and video files at Twitter, but you can also download the original files to store locally. These can then be used to serve different sizes of images locally. See the <a class="reference external" href="#fetch-files-media">Fetch Files management command</a> below.</p>
<section id="set-up">
<h2>Set-up<a class="headerlink" href="#set-up" title="Link to this heading"></a></h2>
<p>Go to <a class="reference external" href="https://developer.twitter.com/portal">https://developer.twitter.com/portal</a>. You’ll need to sign up for a Developer Account, and then create a new App for your Twitter account. Note down the three credentials it says that you should note down.</p>
<p>When viewing your App’s details, click the “Edit” button, then the “Keys and tokens” tab.</p>
<p>In the “Access Token and Secret” section, tap the “Generate” button. Make a note of the Access Token and Access Token Secret.</p>
<p>Django Ditto currently uses the v1.1 Twitter API rather than the latest v2. Unfortunately, accessing v1.1 requires that you apply for “Elevated” access before the API calls used will work. You can do that here: <a class="reference external" href="https://developer.twitter.com/en/portal/products/elevated">https://developer.twitter.com/en/portal/products/elevated</a> You will then need to wait for approval.</p>
<p>Once you have that, go to the Django admin, and add a new <code class="docutils literal notranslate"><span class="pre">Account</span></code> in the Twitter app. Copy the API Key, API Key Secret, Access Token and Access Token Secret from your Twitter App into the Django admin (ignore the other fields), and save the account. A new <code class="docutils literal notranslate"><span class="pre">User</span></code> object will be created, reflecting the Twitter user your API credentials are associated with. If it’s worked your Account should have a title like <strong>&#64;philgyford</strong> instead of a number like <strong>1</strong>.</p>
<p>Once this is done you’ll need to import a downloaded archive of Tweets, and/or fetch Tweets from the Twitter API. See <a class="reference internal" href="#twitter-management-commands"><span class="std std-ref">Management commands</span></a> below.</p>
</section>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h2>
<p>The models available in <code class="docutils literal notranslate"><span class="pre">ditto.twitter.models</span></code> are:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Account</span></code></dt><dd><p>Representing a Twitter account that has API credentials and that we fetch Tweets and/or Likes for. It has a one-to-one relationship with a <code class="docutils literal notranslate"><span class="pre">User</span></code> model.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Media</span></code></dt><dd><p>A photo, video or Animated GIF that was attached to one or more Tweets. Its <code class="docutils literal notranslate"><span class="pre">media_type</span></code> property differentiates between <code class="docutils literal notranslate"><span class="pre">'photo'</span></code>, <code class="docutils literal notranslate"><span class="pre">'video'</span></code> and <code class="docutils literal notranslate"><span class="pre">'animated_gif'</span></code>. (Yes, the plural model name is a bit confusing, sorry.) The files for photos and animated GIFs can be fetched from Twitter and used locally, although this isn’t the default. See the <a class="reference external" href="#fetch-files-media">Fetch Files management command</a> below.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet</span></code></dt><dd><p>A Tweet. It may have been posted by one of the Users with an <code class="docutils literal notranslate"><span class="pre">Account</span></code> that we fetch Twets for. Or it might have been posted by a different <code class="docutils literal notranslate"><span class="pre">User</span></code> and favorited/liked by one of the Users with an <code class="docutils literal notranslate"><span class="pre">Account</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">User</span></code></dt><dd><p>A Twitter user. Every time a Tweet is fetched a new <code class="docutils literal notranslate"><span class="pre">User</span></code> object is created/updated for the person who posted it. One or more of these Users will have an associated <code class="docutils literal notranslate"><span class="pre">Account</span></code>, as these are the user(s) we fetch data for.</p>
</dd>
</dl>
<p>So, you will end up with many <code class="docutils literal notranslate"><span class="pre">User</span></code> objects in the system. But only one (or a few) will be associated with <code class="docutils literal notranslate"><span class="pre">Account</span></code> objects – these are the Users for which you fetch Tweets or favorited/liked Tweets.</p>
</section>
<section id="managers">
<h2>Managers<a class="headerlink" href="#managers" title="Link to this heading"></a></h2>
<section id="media">
<h3>Media<a class="headerlink" href="#media" title="Link to this heading"></a></h3>
<p>For <code class="docutils literal notranslate"><span class="pre">Media</span></code> objects there is only the standard manager available:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Media.objects.all()</span></code></dt><dd><p>Fetches all <code class="docutils literal notranslate"><span class="pre">Media</span></code> objects, attached to Tweets by anyone, whether public or private.</p>
</dd>
</dl>
<p>There is no concept in Twitter of a ‘private’ photo or video. The same photo
could be posted by different public and private Twitter users. Exercise caution
when displaying <code class="docutils literal notranslate"><span class="pre">Media</span></code> objects to public webpages.</p>
</section>
<section id="tweet">
<h3>Tweet<a class="headerlink" href="#tweet" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Tweet</span></code> models have several managers. There are two main differentiators we want to restrict things by:</p>
<ul class="simple">
<li><p><strong>Public vs private:</strong> Whether a Tweet was posted by a public or private Twitter user.</p></li>
<li><p><strong>Posted Tweet vs Favorited Tweet:</strong> Sometimes we’ll want to only fetch Tweets posted by one of the Users with an API-credentialed Account. Sometimes we’ll want to only fetch Tweets those Accounts have favorited/liked. Sometimes we’ll want to fetch ALL Tweets, whether posted or favorited.</p></li>
</ul>
<p>On public-facing web pages you should only use the managers starting <code class="docutils literal notranslate"><span class="pre">Tweet.public_</span></code> as these will filter out all Tweets posted by private Twitter users.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.objects.all()</span></code></dt><dd><p>The default manager fetches <em>all</em> Tweets in the system, posted by all Users, whether they’re public or private, and whether posted by an Account’s User or favorited by them.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.public_objects.all()</span></code></dt><dd><p>Only gets Tweets posted by any Users who are not private. This includes Tweets that have simply been favorited/liked by one of your Accounts.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.tweet_objects.all()</span></code></dt><dd><p>Only gets Tweets posted by a User with an Account, not favorited by them.  And from both public and private Users.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.public_tweet_objects.all()</span></code></dt><dd><p>Only gets Tweets posted by a User with an Account, not favorited by them, but only for Users who aren’t private. For use on public pages.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.favorite_objects.all()</span></code></dt><dd><p>Only gets Tweets favorited by a User with an Account, whether those Tweets are posted by public or private Users.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Tweet.public_favorite_objects.all()</span></code></dt><dd><p>Only gets Tweets favorited by a User with an Account, and only Tweets posted by Users who aren’t private.</p>
</dd>
</dl>
<p>Of course, these can all be filtered as usual. So, if you wanted to get all the public Tweets posted by a particular <code class="docutils literal notranslate"><span class="pre">User</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">ditto.twitter.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">User</span><span class="p">,</span> <span class="n">Tweet</span>

<span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span><span class="p">)</span>
<span class="n">tweets</span> <span class="o">=</span> <span class="n">Tweet</span><span class="o">.</span><span class="n">public_tweet_objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
<p>And to get public Tweets that user has favorited:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">favorites</span> <span class="o">=</span> <span class="n">Tweet</span><span class="o">.</span><span class="n">public_favorite_objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="template-tags">
<h2>Template tags<a class="headerlink" href="#template-tags" title="Link to this heading"></a></h2>
<p>There are four assigment template tags available for displaying Tweets in your templates.</p>
<section id="annual-favorite-counts">
<h3>Annual Favorite Counts<a class="headerlink" href="#annual-favorite-counts" title="Link to this heading"></a></h3>
<p>Get the number of favorites per year by all or one of the non-private Users-with-Accounts (only counting public Tweets):</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">annual_favorite_counts</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">row</span> <span class="k">in</span> <span class="nv">counts</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">row.year</span> <span class="cp">}}</span><span class="x">: </span><span class="cp">{{</span> <span class="nv">row.count</span> <span class="cp">}}</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">count</span></code> in each row are integers.</p>
<p>Or we can restrict this to favorites by a single User-with-an-Account:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">annual_favorite_counts</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>NOTE: The date used is the date the Tweets were posted on, not the date on which they were favorited.</p>
</section>
<section id="annual-tweet-counts">
<h3>Annual Tweet Counts<a class="headerlink" href="#annual-tweet-counts" title="Link to this heading"></a></h3>
<p>Get the number of Tweets per year by all or one of the non-private Users-with-Accounts:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">annual_tweet_counts</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">row</span> <span class="k">in</span> <span class="nv">counts</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">row.year</span> <span class="cp">}}</span><span class="x">: </span><span class="cp">{{</span> <span class="nv">row.count</span> <span class="cp">}}</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal notranslate"><span class="pre">year</span></code> and <code class="docutils literal notranslate"><span class="pre">count</span></code> in each row are integers.</p>
<p>Or we can restrict this to Tweets posted by a single User-with-an-Account:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">annual_tweet_counts</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="k">as</span> <span class="nv">counts</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="day-favorites">
<h3>Day Favorites<a class="headerlink" href="#day-favorites" title="Link to this heading"></a></h3>
<p>Use this to fetch Tweets posted on a particular day by non-private Users, which
have been favorited/liked by any of the Users-with-Accounts. Again, <code class="docutils literal notranslate"><span class="pre">my_date</span></code> is a <a class="reference external" href="https://docs.python.org/3.5/library/datetime.html#datetime.date">datetime.datetime.date</a> type:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">day_favorites</span> <span class="nv">my_date</span> <span class="k">as</span> <span class="nv">favorites</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>NOTE: The date is the date the Tweets were posted on, not the date on which they were favorited.</p>
<p>Again, we can restrict this to Tweets favorited by a single User-with-an-Account:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">day_favorites</span> <span class="nv">my_date</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="k">as</span> <span class="nv">favorites</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="day-tweets">
<h3>Day Tweets<a class="headerlink" href="#day-tweets" title="Link to this heading"></a></h3>
<p>Gets Tweets posted on a particular day by any of the non-private Users-with-Accounts. In this example, <code class="docutils literal notranslate"><span class="pre">my_date</span></code> is a <a class="reference external" href="https://docs.python.org/3.5/library/datetime.html#datetime.date">datetime.datetime.date</a> type:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">day_tweets</span> <span class="nv">my_date</span> <span class="k">as</span> <span class="nv">tweets</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Or we can restrict this to Tweets posted by a single User-with-an-Account:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">day_tweets</span> <span class="nv">my_date</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="k">as</span> <span class="nv">tweets</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="recent-favorites">
<h3>Recent Favorites<a class="headerlink" href="#recent-favorites" title="Link to this heading"></a></h3>
<p>This works like <code class="docutils literal notranslate"><span class="pre">recent_tweets</span></code> except it only fetches Tweets favorited/liked
by our Users-with-Accounts, which were posted by public Twitter users:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">recent_favorites</span> <span class="k">as</span> <span class="nv">favorites</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Similarly, we can change the number of Tweets returned (10 by default), and only return Tweets favorited by a particular User:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">recent_favorites</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="nv">limit</span><span class="o">=</span><span class="m">5</span> <span class="k">as</span> <span class="nv">favorites</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
<section id="recent-tweets">
<h3>Recent Tweets<a class="headerlink" href="#recent-tweets" title="Link to this heading"></a></h3>
<p>To display the most recent Tweets posted by any of the non-private Users with an API-credentialled Account. By default the most recent 10 are fetched:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">load</span> <span class="nv">ditto_twitter</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">recent_tweets</span> <span class="k">as</span> <span class="nv">tweets</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">for</span> <span class="nv">tweet</span> <span class="k">in</span> <span class="nv">tweets</span> <span class="cp">%}</span>
<span class="x">    &lt;p&gt;</span>
<span class="x">        &lt;b&gt;</span><span class="cp">{{</span> <span class="nv">tweet.user.name</span> <span class="cp">}}</span><span class="x"> (@</span><span class="cp">{{</span> <span class="nv">tweet.user.screen_name</span> <span class="cp">}}</span><span class="x">)&lt;/b&gt;&lt;br&gt;</span>
<span class="x">        </span><span class="cp">{{</span> <span class="nv">tweet.text_html</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span>
<span class="x">    &lt;/p&gt;</span>
<span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>(There’s a lot more to displaying Tweets in full; see the included templates for examples.)</p>
<p>The tag can also fetch a different number of Tweets and/or only get Tweets from a single User-with-an-Account. Here we only get the 5 most recent Tweets posted by the User with a <code class="docutils literal notranslate"><span class="pre">screen_name</span></code> of <code class="docutils literal notranslate"><span class="pre">'philgyford'</span></code>:</p>
<div class="highlight-django notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">recent_tweets</span> <span class="nv">screen_name</span><span class="o">=</span><span class="s1">&#39;philgyford&#39;</span> <span class="nv">limit</span><span class="o">=</span><span class="m">5</span> <span class="k">as</span> <span class="nv">tweets</span> <span class="cp">%}</span>
</pre></div>
</div>
</section>
</section>
<section id="management-commands">
<span id="twitter-management-commands"></span><h2>Management commands<a class="headerlink" href="#management-commands" title="Link to this heading"></a></h2>
<section id="import-tweets">
<h3>Import Tweets<a class="headerlink" href="#import-tweets" title="Link to this heading"></a></h3>
<p>If you have more than 3,200 Tweets, you can only include older Tweets by downloading your archive and importing it. To do so, request your archive at <a class="reference external" href="https://twitter.com/settings/download_your_data">https://twitter.com/settings/download_your_data</a> . When you’ve downloaded it, do:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>import_twitter_tweets<span class="w"> </span>--path<span class="o">=</span>/path/to/twitter-2022-01-31-123456abcdef
</pre></div>
</div>
<p>using the correct path to the directory you’ve downloaded and unzipped (in this case, the unzipped directory is <code class="docutils literal notranslate"><span class="pre">twitter-2022-01-031-123456abcdef</span></code>). This will import all of the Tweets found in the archive and all of the images and animated GIFs’ MP4 files (other videos aren’t currently imported).</p>
<p><strong>NOTE:</strong> If you have an archive of data you downloaded before sometime in early 2019 it will be a different format. You can tell because the folder will contain five directories, and three files: <code class="docutils literal notranslate"><span class="pre">index.html</span></code>, <code class="docutils literal notranslate"><span class="pre">README.txt</span></code>, and <code class="docutils literal notranslate"><span class="pre">tweets.csv</span></code>. If you want to import an archive in this format add the <cite>–archive-version=v1</cite> argument:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>import_twitter_tweets<span class="w"> </span>--archive-version<span class="o">=</span>v1<span class="w"> </span>--path<span class="o">=</span>/path/to/123456_abcdef
</pre></div>
</div>
<p>using the correct path to the directory (in this case, the unzipped directory is <code class="docutils literal notranslate"><span class="pre">123456_abcdef</span></code>). This will import Tweet data but no images etc, because these files weren’t included in the older archive format.</p>
</section>
<section id="update-tweets">
<h3>Update Tweets<a class="headerlink" href="#update-tweets" title="Link to this heading"></a></h3>
<p>If you’ve imported your Tweets (above), you won’t yet have complete data about each one. To fully-populate those Tweets you should run this (replacing <code class="docutils literal notranslate"><span class="pre">philgyford</span></code> with your Twitter screen name):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>update_twitter_tweets<span class="w"> </span>--account<span class="o">=</span>philgyford
</pre></div>
</div>
<p>This will fetch data for up to 6,000 Tweets. If you have more than that in your archive, run it every 15 minutes to avoid rate limiting, until you’ve fetched all of the Tweets. This command will fetch data for the least-recently fetched. It’s worth running every so often in the future, to fetch the latest data (such as Retweet and Like counts).</p>
</section>
<section id="fetch-tweets">
<h3>Fetch Tweets<a class="headerlink" href="#fetch-tweets" title="Link to this heading"></a></h3>
<p>Periodically you’ll want to fetch the latest Tweets. This will fetch only those Tweets posted since you last fetched any:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_tweets<span class="w"> </span>--account<span class="o">=</span>philgyford<span class="w"> </span>--recent<span class="o">=</span>new
</pre></div>
</div>
<p>You might also, or instead, want to fetch more than that. Here we fetch the most recent 200:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_tweets<span class="w"> </span>--account<span class="o">=</span>philgyford<span class="w"> </span>--recent<span class="o">=</span><span class="m">200</span>
</pre></div>
</div>
<p>This would update data such as the Retweet and Like counts for all of the 200 fetched Tweets, even if they’re older than your last fetch. It’s fine to fetch data about Tweets you’ve already fetched; their data will be updated.</p>
<p>If you have more than one Twitter Account in Ditto, the above commands can be run across all of them by omitting the <code class="docutils literal notranslate"><span class="pre">--account</span></code> option. eg:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_tweets<span class="w"> </span>--recent<span class="o">=</span>new
</pre></div>
</div>
</section>
<section id="fetch-favorites">
<h3>Fetch Favorites<a class="headerlink" href="#fetch-favorites" title="Link to this heading"></a></h3>
<p>To fetch recent Tweets that all your Accounts have favorited/liked, run one of these:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_favorites<span class="w"> </span>--recent<span class="o">=</span>new
$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_favorites<span class="w"> </span>--recent<span class="o">=</span><span class="m">200</span>
</pre></div>
</div>
<p>Or restrict to Tweets favorited/liked by a single Account:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_favorites<span class="w"> </span>--account<span class="o">=</span>philgyford<span class="w"> </span>--recent<span class="o">=</span>new
$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_favorites<span class="w"> </span>--account<span class="o">=</span>philgyford<span class="w"> </span>--recent<span class="o">=</span><span class="m">200</span>
</pre></div>
</div>
</section>
<section id="update-users">
<h3>Update Users<a class="headerlink" href="#update-users" title="Link to this heading"></a></h3>
<p>When a Tweet of any kind is fetched, its User data is also stored, and the User’s profile photo (avatar) is downloaded and stored in your project’s <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> directory. You can optionally set the <code class="docutils literal notranslate"><span class="pre">DITTO_TWITTER_DIR_BASE</span></code> setting to change the location. The default is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_TWITTER_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;twitter&#39;</span>
</pre></div>
</div>
<p>If your <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> was set to <code class="docutils literal notranslate"><span class="pre">/var/www/example.com/media/</span></code> then the above setting would save the profile image for the user with a Twitter ID <code class="docutils literal notranslate"><span class="pre">12345678</span></code> to something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/var/www/example.com/media/twitter/avatars/56/78/12345678/my_avatar.jpg
</pre></div>
</div>
<p>You may periodically want to update the stored data about all the Twitter users stored in Ditto. (quantity of Tweets, descriptions, etc). Do it like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>update_twitter_users<span class="w"> </span>--account<span class="o">=</span>philgyford
</pre></div>
</div>
<p>This requires an <code class="docutils literal notranslate"><span class="pre">account</span></code> as the data is fetched from that Twitter user’s point of view, when it comes to privacy etc.</p>
</section>
<section id="fetch-files-media">
<h3>Fetch Files (Media)<a class="headerlink" href="#fetch-files-media" title="Link to this heading"></a></h3>
<p>Fetching Tweets (whether your own or your favorites/likes) fetches all the data <em>about</em> them, but does not fetch any media files uploaded with them. There’s a separate command for fetching images and the MP4 video files created from animated GIFs. (There’s no way to fetch the videos, or original GIF files.)</p>
<p>You <em>must</em> first download the Tweet data (above), and then you can fetch the files for all those Tweets:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_files
</pre></div>
</div>
<p>This will fetch the files for all Tweets whose files haven’t already been fetched. So, the first time, it’s <em>all</em> the Tweets’ files, which can take a while.</p>
<p>If you want to force a re-fetching of all files, whether they’ve already been downloaded or not:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_files<span class="w"> </span>--all
</pre></div>
</div>
<p>Each image/MP4 is associated with the relevant Tweet(s) and saved within your project’s <code class="docutils literal notranslate"><span class="pre">MEDIA_ROOT</span></code> directory, as defined in <code class="docutils literal notranslate"><span class="pre">settings.py</span></code>. There’s one optional setting to customise the directory in which the files are saved. Its default value is as shown here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_TWITTER_DIR_BASE</span> <span class="o">=</span> <span class="s1">&#39;twitter&#39;</span>
</pre></div>
</div>
<p>Files are organised into separate directories according to the final characters
of their file names (so as not to have too many in one directory). eg, an image
might be saved in:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/var/www/example.com/media/twitter/media/6T/ay/CRXEfBEWUAA6Tay.png
</pre></div>
</div>
<p>Every uploaded image, animated GIF and video should have a single image.  Animated GIFs will also have an MP4 file.</p>
<p>Once you’ve downloaded the original files, you can use these to generate all the different sizes of image required for your site, instead of linking direct to the image files on Twitter. To do this, ensure <code class="docutils literal notranslate"><span class="pre">imagekit</span></code> is in your <code class="docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code> setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># ...</span>
    <span class="s1">&#39;imagekit&#39;</span><span class="p">,</span>
    <span class="c1"># ...</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And add this to your <cite>settings.py</cite> (its default value is <code class="docutils literal notranslate"><span class="pre">False</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DITTO_TWITTER_USE_LOCAL_MEDIA</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p>Any requests in your templates for the URLs of photo files of any size will now use resized versions of your downloaded original files, generated by Imagekit.  The first time you load a page (especially if it lists many images) it will be slow, but the images are cached (in a <code class="docutils literal notranslate"><span class="pre">CACHE</span></code> directory in your media folder).</p>
<p>For example, before changing this setting, the URL of small image (<code class="docutils literal notranslate"><span class="pre">Media.small_url</span></code>) would be something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>https://pbs.twimg.com/media/CjuCDVLXIAALhYz.jpg:small
</pre></div>
</div>
<p>After choosing to use local photos, it would be something like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/media/CACHE/images/twitter/media/Lh/Yz/CjuCDVLXIAALhYz/5a726ea25d3bbd1b35b21b8b61b98c4c.jpg
</pre></div>
</div>
<p>If you change your mind you can switch back to using the images hosted on Twitter by removing the <code class="docutils literal notranslate"><span class="pre">DITTO_TWITTER_USE_LOCAL_MEDIA</span></code> setting or changing it to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>Animated GIFs are converted into MP4 videos when first uploaded to Twitter.  Ditto downloads and uses these in a similar way to images. ie, by default the <code class="docutils literal notranslate"><span class="pre">video_url</span></code> property of a <code class="docutils literal notranslate"><span class="pre">Media</span></code> object that’s an Animated GIF would be like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>https://pbs.twimg.com/tweet_video/CRXEfBEWUAA6Tay.mp4
</pre></div>
</div>
<p>If it’s been downloaded and <code class="docutils literal notranslate"><span class="pre">DITTO_TWITTER_USE_LOCAL_MEDIA</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> then
calling <code class="docutils literal notranslate"><span class="pre">video_url</span></code> would return a URL like:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>/media/twitter/media/6T/ay/CRXEfBEWUAA6Tay.mp4
</pre></div>
</div>
<p>However, there’s no way to download actual videos that were uploaded to Twitter, and so Ditto will always try to use videos hosted on Twitter, no matter what the value of <code class="docutils literal notranslate"><span class="pre">DITTO_TWITTER_USE_LOCAL_MEDIA</span></code>.</p>
</section>
<section id="fetch-accounts">
<h3>Fetch Accounts<a class="headerlink" href="#fetch-accounts" title="Link to this heading"></a></h3>
<p><strong>Deprecated:</strong> This only needs to be used whenever a new <code class="docutils literal notranslate"><span class="pre">Account</span></code> is added to the system.  It fetches the <code class="docutils literal notranslate"><span class="pre">User</span></code> data for each <code class="docutils literal notranslate"><span class="pre">Account</span></code> that has API credentials, and associates the two objects.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>./manage.py<span class="w"> </span>fetch_twitter_accounts
</pre></div>
</div>
<p>I don’t think this is needed now.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pinboard.html" class="btn btn-neutral float-left" title="Pinboard" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../development.html" class="btn btn-neutral float-right" title="Development" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-25, Phil Gyford.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>